<!DOCTYPE html>
<html class="dark" lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  
  <!-- ✅ SEO META TAGS -->
  <title>صلّوا لأجلنا | Pray for Us – صلوات من أجل الأنفس المطهرية</title>
  <meta name="description" content="صلّوا لأجلنا - موقع كاثوليكي للصلاة من أجل الأنفس المطهرية. سجّل أسماء أحبّائك الراحلين لذكرهم في القداديس والصلوات. Pray for the Holy Souls in Purgatory with faith and love."/>
  <meta name="keywords" content="صلوا لأجلنا, الأنفس المطهرية, المطهر, صلوات الموتى, كاثوليك, purgatory, catholic prayers, holy souls, pray for the dead, صلوات للراحلين"/>
  <meta name="author" content="Prayforus.help"/>
  <meta name="robots" content="index, follow"/>

  <!-- Canonical and Language -->
  <link rel="canonical" href="https://prayforus.help/"/>
  <link rel="alternate" hreflang="ar" href="https://prayforus.help/ar/"/>
  <link rel="alternate" hreflang="en" href="https://prayforus.help/en/"/>

  <!-- Open Graph -->
  <meta property="og:title" content="صلّوا لأجلنا | Pray for Us"/>
  <meta property="og:description" content="موقع للصلاة من أجل الأنفس المطهرية. أدرج أسماء أحبّائك الراحلين في سجلّ الصلوات المقدسة."/>
  <meta property="og:image" content="https://prayforus.help/pictures/light.jpg"/>
  <meta property="og:url" content="https://prayforus.help/"/>
  <meta property="og:type" content="website"/>
  <meta property="og:site_name" content="Prayforus.help"/>
  <meta property="og:locale" content="ar_AR"/>

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="صلّوا لأجلنا | Pray for Us"/>
  <meta name="twitter:description" content="Pray for the Holy Souls in Purgatory – Join us in faith and remembrance."/>
  <meta name="twitter:image" content="https://prayforus.help/pictures/light.jpg"/>

  <!-- Favicon and Sitemap -->
  <link rel="icon" type="image/png" href="https://prayforus.help/favicon.png"/>
  <link rel="sitemap" type="application/xml" href="https://prayforus.help/sitemap.xml"/>

  <!-- Structured Data: Organization -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "Prayforus.help",
    "url": "https://prayforus.help",
    "logo": "https://prayforus.help/logo.png",
    "sameAs": [
      "https://www.facebook.com/prayforus.help",
      "https://www.instagram.com/prayforus.help"
    ],
    "description": "A Catholic platform for prayer and intercession for the Holy Souls in Purgatory.",
    "foundingDate": "2025-01-01",
    "address": { "@type": "PostalAddress", "addressCountry": "LB" },
    "contactPoint": { "@type": "ContactPoint", "contactType": "Support", "email": "contact@prayforus.help" }
  }
  </script>

  <!-- Structured Data: Event (Prayer Registry) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Event",
    "name": "Holy Souls Prayer Registry",
    "eventAttendanceMode": "https://schema.org/OnlineEventAttendanceMode",
    "eventStatus": "https://schema.org/EventScheduled",
    "url": "https://prayforus.help",
    "description": "Join daily prayers and Mass intentions for the Holy Souls in Purgatory.",
    "startDate": "2025-11-01T00:00:00Z",
    "endDate": "2025-12-31T23:59:00Z",
    "organizer": {
      "@type": "Organization",
      "name": "Prayforus.help",
      "url": "https://prayforus.help"
    }
  }
  </script>
  <!-- ✅ END SEO META TAGS -->


  <!-- Tailwind + Fonts (your original setup preserved) -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=church" />
  <link href="https://fonts.googleapis.com" rel="preconnect"/>
  <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200..1000&family=Lora:ital,wght@0,400..700;1,400..700&amp;family=Karla:ital,wght@0,200..800;1,200..800&amp;display=swap" rel="stylesheet"/>

  <!-- Your Tailwind Configuration remains unchanged -->
  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            'isabelline': { DEFAULT: '#edede9', 100: '#34342a', 200: '#676754', 300: '#989881', 400: '#c2c2b5', 500: '#edede9', 600: '#f0f0ed', 700: '#f4f4f2', 800: '#f8f8f6', 900: '#fbfbfb' },
            'timberwolf': { DEFAULT: '#d6ccc2', 100: '#312921', 200: '#625241', 300: '#937a62', 400: '#b6a391', 500: '#d6ccc2', 600: '#ded6ce', 700: '#e7e0da', 800: '#efebe7', 900: '#f7f5f3' },
            'linen': { DEFAULT: '#f5ebe0', 100: '#473017', 200: '#8e5f2e', 300: '#c78f52', 400: '#debd99', 500: '#f5ebe0', 600: '#f7efe6', 700: '#f9f3ed', 800: '#fbf7f3', 900: '#fdfbf9' },
            'champagne_pink': { DEFAULT: '#e3d5ca', 100: '#38291e', 200: '#70523b', 300: '#a87b59', 400: '#c5a891', 500: '#e3d5ca', 600: '#e8ddd4', 700: '#eee6df', 800: '#f4eeea', 900: '#f9f7f4' },
            'pale_dogwood': { DEFAULT: '#d5bdaf', 100: '#33241b', 200: '#664735', 300: '#986b50', 400: '#ba937c', 500: '#d5bdaf', 600: '#ddcabf', 700: '#e6d7cf', 800: '#eee4df', 900: '#f7f2ef' },
            "primary": "#edede9",
            "secondary": "#a87b59",
            "background-light": "#f6f6f8",
            "background-dark": "#101622",
            "anf-blue": "#003366",
            "anf-burgundy": "#800020",
            "anf-text": "#333333",
            "anf-background": "#FDFBF7",
            "brand": {
              "blue": "#003366",
              "burgundy": "#800020",
              "background": "#F8F5F2",
              "text": "#444444",
              "dark-bg": "#33241b",
              "dark-surface": "#38291e",
              "dark-text": "#f5ebe0",
              "dark-subtle": "#d5bdaf"
            }
          },
          fontFamily: {
            "display": ["Cairo", "Lora", "serif"],
            "body": ["Cairo", "Karla", "sans-serif"],
          },
          borderRadius: {
            "DEFAULT": "0.5rem",
            "lg": "0.75rem",
            "xl": "1rem",
            "full": "9999px"
          },
          boxShadow: {
            soft: "0 4px 20px rgba(0,0,0,0.2)",
            glow: "0 0 15px rgba(214, 204, 194, 0.25)"
          },
        },
      },
    }
  </script>
</head>
 
<!-- BODY: Classes are already mapped to the config variables -->
<body class="bg-brand-dark-bg font-body text-brand-dark-text">
<div class="relative flex h-auto min-h-screen w-full flex-col group/design-root overflow-x-hidden">
<div class="layout-container flex h-full grow flex-col">
<div class="flex flex-1 justify-center">
<div class="layout-content-container flex flex-col w-full">
<!-- HEADER: Updated border color -->
<header class="sticky top-0 z-50 backdrop-blur-md bg-brand-dark-bg/80 border-b border-secondary/40 shadow-soft transition">
  <div class="max-w-7xl mx-auto flex justify-between items-center px-6 py-4">
    <nav class="flex gap-6 text-sm font-medium">
      <a href="aboutus.html" class="hover:text-primary transition">من نحن</a>
      <a href="contactus.html" class="hover:text-primary transition">إتصل بنا</a>
    </nav>
    <div class="flex items-center gap-2">
      <!-- Icon uses text-primary, which is mapped -->
      <span class="material-symbols-outlined text-primary text-3xl">church</span>
      <h1 class="text-primary text-2xl font-bold font-display">Prayforus.help</h1>
    </div>
  </div>
</header>

<main class="flex-grow">
<div class="relative">
<div class="h-96 md:h-[500px] w-full overflow-hidden">
<img alt="Stained glass window depicting a dove" class="w-full h-full object-cover" src="pictures/dark.png"/>
<!-- Gradient uses from-brand-dark-bg, which is mapped -->
<div class="absolute inset-0 bg-gradient-to-t from-brand-dark-bg via-brand-dark-bg/15 to-transparent"></div>
</div>
<div class="absolute inset-0 flex flex-col justify-center items-center text-center px-4">
<!-- HERO TEXT: Replaced text-cornsilk with new text-brand-dark-text -->
<h1 class="text-brand-dark-text text-4xl md:text-8xl font-bold leading-tight tracking-tight font-display drop-shadow-lg">صلّوا لأجلنا</h1>
<p class="text-brand-dark-text text-xl md:text-4xl mt-8 font-normal drop-shadow-lg">  ܨܠܘ ܥܠ ܐܦܝܢ   </p>
</div>
</div>
<div class="px-4 sm:px-6 lg:px-8 py-10 md:py-16">
<div class="max-w-3xl mx-auto -mt-32 md:-mt-48 relative z-10">
<div class="text-center mb-8">
<!-- Text box uses mapped bg-brand-dark-surface and text-brand-dark-text -->
<div class="text-brand-dark-text text-base md:text-lg max-w-2xl mx-auto bg-brand-dark-surface/50 backdrop-blur-sm p-6 rounded-xl space-y-4 text-right">
<p>نحن، أبناء الكنيسة الكاثوليكيّة المقدّسة، نؤمن إيمانًا راسخًا بقوّة الصلاة وشفاعة المؤمنين من أجل الأنفس المطهريّة، تلك النفوس التي تتوق إلى رؤية وجه الله في مجده الأبدي. فالكنيسة، أمّ ومعلّمة، تذكّرنا على الدوام بأنّ <strong>شركة القدّيسين</strong> تمتدّ ما بين السماء والأرض والمطهر، إذ يستطيع المؤمنون الأحياء أن يقدّموا العون لإخوتهم المتألّمين من خلال الصلاة، والاشتراك في الذبيحة الإلهيّة، وأعمال الرحمة والتكفير.</p>
<p>يعرّف <strong>التعليم المسيحي للكنيسة الكاثوليكية</strong> المطهر بأنّه:</p>
<!-- BLOCKQUOTE: Updated border color -->
<blockquote class="border-r-4 border-secondary pr-4 my-4">
<p class="italic">«تطهيرٌ يُعدّ النفس لبلوغ القداسة اللازمة للدخول في فرح السماء»،</p>
<p class="italic">وهو اختبارٌ يعيشه أولئك «الذين يموتون في نعمة الله وصداقته، ولم يتطهروا بعد تطهيرا كاملا» (ت ا ك، رقم 1030).</p>
</blockquote>
<p>ويشير أيضًا إلى أنّ:</p>
<!-- BLOCKQUOTE: Updated border color -->
<blockquote class="border-r-4 border-secondary pr-4 my-4">
<p class="italic">«هذا التطهير للمختارين... يختلف كليًّا عن عقاب الهالكين» (<em>رقم 1031</em>).</p>
</blockquote>
<p>وانطلاقًا من هذا الإيمان الحيّ، ندعوك إلى تدوين أسماء أحبّائك الراحلين في سجلّ الأنفس المطهريّة أدناه، لتُرفَع إلى الله في صلوات الكنيسة وشفاعتها الدائمة. وعند إدراج أسمائهم، تُذكَر نفوسهم في الذبائح الإلهيّة و في صلوات <strong>جماعة الأنفس المطهريّة</strong>.</p>
</div>
</div>
<!-- FORM CARD: Updated border color -->
<div class="bg-brand-dark-surface/80 p-8 md:p-12 rounded-xl shadow-2xl border border-secondary backdrop-blur-xl">

<!-- Progress Bar Start -->
<div class="flex items-center justify-between max-w-sm mx-auto mb-10" dir="ltr">
 
  <!-- Step 1: Active (Uses bg-primary) -->
  <div class="flex flex-col items-center text-center">
    <!-- Updated text color on button to be dark-bg for contrast -->
    <div class="flex items-center justify-center w-10 h-10 rounded-full bg-primary text-brand-dark-bg font-bold text-lg">1</div>
    <p class="mt-2 text-xs font-medium text-primary">معلوماتك</p>
  </div>

  <!-- Connector (Uses bg-brand-dark-subtle) -->
  <div class="flex-auto h-0.5 bg-brand-dark-subtle mx-2"></div>

  <!-- Step 2: Inactive (Uses border/text-brand-dark-subtle) -->
  <div class="flex flex-col items-center text-center">
    <div class="flex items-center justify-center w-10 h-10 rounded-full border-2 border-brand-dark-subtle text-brand-dark-subtle font-bold text-lg">2</div>
    <p class="mt-2 text-xs font-medium text-brand-dark-subtle">أسماء الأحباء</p>
  </div>

  <!-- Connector (Uses bg-brand-dark-subtle) -->
  <div class="flex-auto h-0.5 bg-brand-dark-subtle mx-2"></div>

  <!-- Step 3: Inactive (Uses border/text-brand-dark-subtle) -->
  <div class="flex flex-col items-center text-center">
    <div class="flex items-center justify-center w-10 h-10 rounded-full border-2 border-brand-dark-subtle text-brand-dark-subtle font-bold text-lg">3</div>
    <p class="mt-2 text-xs font-medium text-brand-dark-subtle">تسجيل</p>
  </div>

</div>
<!-- Progress Bar End -->
<h2 class="text-primary text-3xl font-bold font-display text-center mb-8">أدرج أسماء من تحبّ </h2>
<form class="space-y-6" id="registry-form">
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<label class="flex flex-col">
<!-- Text uses text-brand-dark-subtle -->
<p class="text-brand-dark-subtle text-sm font-medium mb-2">الإسم</p>
<!-- INPUT: Updated border, bg, and focus colors -->
<input class="form-input flex w-full text-brand-dark-text focus:outline-none focus:ring-2 focus:ring-primary/50 border border-secondary bg-brand-dark-bg focus:border-primary h-12 px-4 text-base transition-colors" placeholder="" type="text" id="first-name" required dir="auto"/>
</label>
<label class="flex flex-col">
<p class="text-brand-dark-subtle text-sm font-medium mb-2">الشهرة</p>
<!-- INPUT: Updated border, bg, and focus colors -->
<input class="form-input flex w-full text-brand-dark-text focus:outline-none focus:ring-2 focus:ring-primary/50 border border-secondary bg-brand-dark-bg focus:border-primary h-12 px-4 text-base transition-colors" placeholder="" type="text" id="last-name" required dir="auto"/>
</label>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<label class="flex flex-col">
<p class="text-brand-dark-subtle text-sm font-medium mb-2">البريد الإلكتروني</p>
<!-- INPUT: Updated border, bg, and focus colors -->
<input class="form-input flex w-full text-brand-dark-text focus:outline-none focus:ring-2 focus:ring-primary/50 border border-secondary bg-brand-dark-bg focus:border-primary h-12 px-4 text-base transition-colors" placeholder="" type="email" id="email" required dir="ltr"/>
</label>
<label class="flex flex-col">
<p class="text-brand-dark-subtle text-sm font-medium mb-2">تأكيد البريد الإلكتروني</p>
<!-- INPUT: Updated border, bg, and focus colors -->
<input class="form-input flex w-full text-brand-dark-text focus:outline-none focus:ring-2 focus:ring-primary/50 border border-secondary bg-brand-dark-bg focus:border-primary h-12 px-4 text-base transition-colors" placeholder="" type="email" id="confirm-email" required dir="ltr"/>
</label>
</div>

<div class="space-y-4">
  <div>
    <label class="flex flex-col">
      <!-- NOTE: text-brand-white-subtle was in your original code, corrected to text-brand-dark-subtle -->
      <p class="text-brand-dark-subtle text-sm font-medium mb-2">أدخل الإسم</p>
      <p class="text-brand-dark-subtle text-xs mt-2 mb-2">أضف إسماً واحداً في كل مرة.</p>
    </label>
    <div class="flex gap-3">
      <!-- INPUT: Updated border, bg, and focus colors -->
      <input class="form-input flex w-full text-brand-dark-text focus:outline-none focus:ring-2 focus:ring-primary/50 border border-secondary bg-brand-dark-bg focus:border-primary h-12 px-4 text-base transition-colors" placeholder="سمعان بطرس" type="text" id="name-input" dir="rtl"/>
    </div>
  </div>

  <div>
    <label class="flex flex-col">
      <p class="text-brand-dark-subtle text-sm font-medium mb-2">تاريخ الوفاة (اختياري)</p>
      <div class="grid grid-cols-3 gap-3" dir="rtl">
        <!-- SELECT: Updated border, bg, and focus colors -->
        <select id="name-dod-year" class="form-select flex w-full text-brand-dark-text focus:outline-none focus:ring-2 focus:ring-primary/50 border border-secondary bg-brand-dark-bg focus:border-primary h-12 text-base transition-colors rounded-lg">
          <option value="">السنة</option>
          <!-- JS will populate this -->
        </select>
        <!-- SELECT: Updated border, bg, and focus colors -->
        <select id="name-dod-month" class="form-select flex w-full text-brand-dark-text focus:outline-none focus:ring-2 focus:ring-primary/50 border border-secondary bg-brand-dark-bg focus:border-primary h-12 text-base transition-colors rounded-lg">
          <option value="">الشهر</option>
          <!-- JS will populate this -->
        </select>
        <!-- SELECT: Updated border, bg, and focus colors -->
        <select id="name-dod-day" class="form-select flex w-full text-brand-dark-text focus:outline-none focus:ring-2 focus:ring-primary/50 border border-secondary bg-brand-dark-bg focus:border-primary h-12 text-base transition-colors rounded-lg">
          <option value="">اليوم</option>
          <!-- JS will populate this -->
        </select>
      </div>
    </label>
  </div>
  
  <!-- ADD NAME BUTTON: Updated bg, hover, text, and ring colors -->
  <button type="button" id="add-name-btn" class="w-full bg-primary hover:bg-timberwolf-700 text-brand-dark-bg font-bold py-3 px-5 rounded-lg focus:outline-none focus:ring-4 focus:ring-offset-2 focus:ring-offset-brand-dark-surface focus:ring-primary/50 transition-all duration-300 ease-in-out">
      إضافة الاسم
  </button>
  
  <!-- Updated border color for divider -->
  <div id="names-list-container" class="mt-4 pt-4 border-t border-secondary/30 space-y-2">
    <!-- الأسماء المضافة ستظهر هنا -->
  </div>
</div>
<!-- End of MODIFICATION -->

<div class="pt-4">
<!-- SUBMIT BUTTON: Updated bg, hover, text, and ring colors -->
<button class="w-full bg-secondary hover:bg-champagne_pink-400 text-brand-dark-text font-bold py-4 px-4 rounded-lg focus:outline-none focus:ring-4 focus:ring-offset-2 focus:ring-offset-brand-dark-surface focus:ring-champagne_pink-400/50 transition-all duration-300 ease-in-out transform hover:scale-[1.01] text-lg" type="submit" id="submit-button"> تسجيل </button>
</div>
</form>
<div id="form-message" class="text-center mt-6 text-lg"></div>
<div class="text-center mt-8">
<!-- Text uses mapped text-brand-dark-text -->
<p class="text-lg text-brand-dark-text">ولا يَدخُلُها شيءٌ نَجِسٌ، ولا الذينَ يَعمَلونَ القَبائِـحَ ويفتَرُونَ الكَذِبَ، بَلِ الذينَ أسماؤُهُم مكتوبَةٌ في كِتابِ الحياةِ، كِتابِ الحَمَلِ.&ensp;  (رؤيا يوحنا 27:21 )</p>
<!-- Text uses mapped text-brand-dark-subtle and primary -->
<p class="text-xs text-brand-dark-subtle mt-6"> نحن نولي أهمية كبيرة لبياناتك وخصوصيتك. سيتم الحفاظ على معلوماتك بأمان، وستُستخدم للتواصل معك فقط. <a class="text-primary hover:underline" href="#"> </a> </p>
</div>
</div>
</div>
</div>
</main>
<footer class="text-center py-8 border-t border-brand-dark-bg text-sm text-brand-dark-subtle">
  © 2025 Prayforus.help – جميع الحقوق محفوظة.

  <span id="visits" class="block mt-4 text-xl font-semibold text-amber-400 tracking-wide drop-shadow-sm">
    ✝️ عدد الزائرين : ...
  </span>
</footer>

<script>
const endpoint = "https://script.google.com/macros/s/AKfycbx_oYliOhD_rVbfXNqbgv5TEEbMouE8zphIpzdFYEhXG8228lMnqOl4m3znJGMk9YmQ/exec";

fetch(endpoint)
  .then(res => res.json())
  .then(data => {
    const visits = data.visits ?? "؟";
    document.getElementById("visits").innerHTML =
      `✝️ عدد الزائرين : <span class="text-primary drop-shadow glow">${visits}</span>`;
  })
  .catch(() => {
    document.getElementById("visits").textContent = "عدد الزيارات: غير متاح حالياً";
  });
</script>

<style>
.glow {
  color: #fff8dc;
  text-shadow: 0 0 8px rgba(255, 255, 224, 0.4);
  font-weight: 700;
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {

  // --- MODIFICATION: Populate Date of Death Dropdowns for Name Input ---
  const yearSelect = document.getElementById('name-dod-year');
  const monthSelect = document.getElementById('name-dod-month');
  const daySelect = document.getElementById('name-dod-day');

  const currentYear = new Date().getFullYear();
  // Populate Years (e.g., 2025 down to 1920)
  for (let y = currentYear; y >= 1920; y--) {
    const option = document.createElement('option');
    option.value = y;
    option.textContent = y;
    yearSelect.appendChild(option);
  }

  // Populate Months (Mashriqi names)
  const months = [
    "كانون الثاني", "شباط", "آذار", "نيسان", "أيار", "حزيران",
    "تموز", "آب", "أيلول", "تشرين الأول", "تشرين الثاني", "كانون الأول"
  ];
  months.forEach((month, index) => {
    const option = document.createElement('option');
    option.value = index + 1; // 1-12
    option.textContent = month;
    monthSelect.appendChild(option);
  });

  // Populate Days (1-31)
  for (let d = 1; d <= 31; d++) {
    const option = document.createElement('option');
    option.value = d;
    option.textContent = d;
    daySelect.appendChild(option);
  }
  // --- End of Date Population ---

  // --- MODIFICATION: Dynamic Name Adder Logic ---
  const nameInput = document.getElementById('name-input');
  const addNameBtn = document.getElementById('add-name-btn');
  const namesContainer = document.getElementById('names-list-container');

  // Get dropdowns for date *per name*
  const nameYearSelect = document.getElementById('name-dod-year');
  const nameMonthSelect = document.getElementById('name-dod-month');
  const nameDaySelect = document.getElementById('name-dod-day');


  function addName() {
    const name = nameInput.value.trim();
    if (name === '') {
        nameInput.focus();
        return; // Don't add empty names
    }

    // --- Get Date from Dropdowns ---
    const year = nameYearSelect.value;
    const month = nameMonthSelect.value;
    const day = nameDaySelect.value;
    
    let dateOfDeath = "";
    if (year && month && day) {
      // Format as YYYY-MM-DD
      const monthPadded = String(month).padStart(2, '0');
      const dayPadded = String(day).padStart(2, '0');
      dateOfDeath = `${year}-${monthPadded}-${dayPadded}`;
    }
    // --- End of Get Date ---

    // Create the name tag element
    // --- NAME TAG: Updated bg and border colors ---
    const nameTag = document.createElement('div');
    nameTag.className = 'flex items-center justify-between bg-brand-dark-bg p-3 rounded-lg border border-secondary';
    nameTag.setAttribute('data-name', name); // Store the name data
    nameTag.setAttribute('data-date', dateOfDeath); // Store the date data

    const textWrapper = document.createElement('div');
    
    const nameText = document.createElement('span');
    nameText.textContent = name;
    // --- Text uses mapped colors ---
    nameText.className = 'text-brand-dark-text font-medium';
    textWrapper.appendChild(nameText);

    // If date was added, display it
    if (dateOfDeath) {
        const dateText = document.createElement('span');
        dateText.textContent = `تاريخ الوفاة: ${dateOfDeath}`;
        // --- Text uses mapped colors ---
        dateText.className = 'block text-xs text-brand-dark-subtle mt-1';
        textWrapper.appendChild(dateText);
    }

    const removeBtn = document.createElement('button');
    removeBtn.type = 'button';
    removeBtn.innerHTML = '&times;'; // '×' character
    removeBtn.className = 'mr-2 text-red-400 hover:text-red-300 font-bold text-2xl leading-none';
    removeBtn.onclick = function() {
      namesContainer.removeChild(nameTag);
    };

    nameTag.appendChild(textWrapper); // Add text (name + optional date)
    nameTag.appendChild(removeBtn);
    namesContainer.appendChild(nameTag);

    // Clear input and reset date dropdowns
    nameInput.value = '';
    nameYearSelect.value = '';
    nameMonthSelect.value = '';
    nameDaySelect.value = '';
    nameInput.focus();
  }

  // Add name on button click
  addNameBtn.addEventListener('click', addName);

  // Add name on 'Enter' key press in the name input
  nameInput.addEventListener('keydown', function(e) {
    if (e.key === 'Enter') {
      e.preventDefault(); // Prevent form submission
      addName();
    }
  });
  // --- End of Dynamic Name Adder Logic ---


  const form = document.getElementById('registry-form');
  const messageEl = document.getElementById('form-message');
  const submitButton = document.getElementById('submit-button');
  
  const WEB_APP_URL = 'https://script.google.com/macros/library/d/1i1_xq-YGMppsDjSSEScNvqE0Veg8YKBf8Fy5iGn8FFRUFbpjFyYxVq2e/1';

  form.addEventListener('submit', function(e) {
    e.preventDefault();

    const firstName = document.getElementById('first-name').value;
    const lastName = document.getElementById('last-name').value;
    const email = document.getElementById('email').value;
    const confirmEmail = document.getElementById('confirm-email').value;
    
    // --- MODIFICATION: Get names and dates from the dynamic list ---
    const nameElements = document.querySelectorAll('#names-list-container [data-name]');
    const namesArray = Array.from(nameElements).map(el => {
        return {
            name: el.getAttribute('data-name'),
            date: el.getAttribute('data-date') || '' // Get date, or empty string if null
        };
    });
    
    // Validation: Check if at least one name is added
    if (namesArray.length === 0) {
      messageEl.textContent = 'يرجى إضافة اسم واحد على الأقل.';
      messageEl.className = 'text-center mt-6 text-lg text-red-400';
      return; // Stop submission
    }
    
    // Join names and dates into a single string for the backend (e.g., "Name 1 (تاريخ الوفاة: 2022-01-01)\nName 2")
    const namesListString = namesArray.map(item => {
        return item.date
            ? `${item.name} (تاريخ الوفاة: ${item.date})`
            : item.name;
    }).join('\n'); // Use newline for readability
    // --- End of MODIFICATION ---
    

    if (email !== confirmEmail) {
      messageEl.textContent = 'البريد الإلكتروني غير متطابق. يرجى التحقق مرة أخرى.';
      messageEl.className = 'text-center mt-6 text-lg text-red-400';
      return;
    }

    const formData = new FormData();
    formData.append('firstName', firstName);
    formData.append('lastName', lastName);
    formData.append('email', email);
    formData.append('namesList', namesListString); // MODIFICATION: Send the new string
    // MODIFICATION: Removed global dateOfDeath
    formData.append('timestamp', new Date().toISOString());

    messageEl.textContent = 'جاري التسجيل...';
    // --- MESSAGE: Use mapped theme color ---
    messageEl.className = 'text-center mt-6 text-lg text-brand-dark-subtle';
    submitButton.disabled = true;
    submitButton.textContent = 'جاري الإرسال...';

    fetch(WEB_APP_URL, {
      method: 'POST',
      body: formData,
      // REMOVED mode: 'no-cors' to properly read the response
    })
    .then(response => response.json()) // Get the JSON response from the Apps Script
    .then(data => {
      if (data.result === 'success') {
        // Data was saved! Now save to localStorage and redirect.
        
        // MODIFICATION: Save only the names to localStorage for the next page
        const justNames = namesArray.map(item => item.name);
        localStorage.setItem('submittedNames', JSON.stringify(justNames));
        
        // Redirect to the submission page
        window.location.href = 'submission.html';
      } else {
        // The Apps Script reported an error
        throw new Error(data.message || 'Error reported by server.');
      }
    })
    .catch(error => {
        console.error('Error!', error.message);
        messageEl.textContent = 'حدث خطأ أثناء الإرسال. يرجى المحاولة مرة أخرى.';
        messageEl.className = 'text-center mt-6 text-lg text-red-400';
    })
    .finally(() => {
        // This will only run if the redirect doesn't happen (i.e., on error)
        submitButton.disabled = false;
        // --- BUTTON: Restore original text ---
        submitButton.textContent = 'تسجيل';
    });
  });
});
</script>

</body>

</html>











